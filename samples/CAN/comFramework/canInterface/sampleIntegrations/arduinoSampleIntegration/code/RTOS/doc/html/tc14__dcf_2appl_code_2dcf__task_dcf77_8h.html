<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RTuinOS: dcf_taskDcf77.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">RTuinOS&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">Small Scale RTOS for Arduino 1.0.5</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>tc14_dcf/applCode/dcf_taskDcf77.h File Reference</h1>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br/>
</div>
<p><a href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdcf__time_info.html">dcf_timeInfo</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#aab11386bbffdc7cc16060a9390c02710">DCF_TASK_STACK_SIZE</a>&#160;&#160;&#160;160</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a86b64e2058de1f8b2ea805532d8a317f">DCF_DIGITAL_LEVEL_DCF_IMPULSE</a>&#160;&#160;&#160;false</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#ab7e8b37e31cfdec90dd9bd09e3aae7b2">dcf_readDcfInput</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a64b2fea5d229953b7919a83c5e67aa7b">dcf_onNewTimeTelegram</a> (const <a class="el" href="structdcf__time_info.html">dcf_timeInfo</a> *const pTimeInfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a71042925c2f50707bfaabdba86e09bec">dcf_initializeTask</a> (uint8_t idxTask, uint8_t prioClass)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Definition of global interface of module dcf_taskDcf77.c</p>
<p>Copyright (C) 2013 Peter Vranken (mailto:<a href="mailto:Peter_Vranken@Yahoo.de">Peter_Vranken@Yahoo.de</a>)</p>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License along with this program. If not, see &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;. </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="aab11386bbffdc7cc16060a9390c02710"></a><!-- doxytag: member="tc14_dcf/applCode/dcf_taskDcf77.h::DCF_TASK_STACK_SIZE" ref="aab11386bbffdc7cc16060a9390c02710" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DCF_TASK_STACK_SIZE&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The stack usage of the DCF task. A value of about 100 Byte plus the need of your notification callback <a class="el" href="setup_8c.html#a64b2fea5d229953b7919a83c5e67aa7b">dcf_onNewTimeTelegram(const dcf_timeInfo * const)</a> is appropriate. </p>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>Be careful if you enable any of the printf statements for debugging purpose in the dcf module: They increase the need for stack memory by some tens of Byte. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>Start with a generous value and use function uint16_t <a class="el" href="rtos_8h.html#a54ca7c825941b0d17877db45d2b4c662">rtos_getStackReserve(uint8_t)</a> in the running application to find out. </dd></dl>

</div>
</div>
<a class="anchor" id="a86b64e2058de1f8b2ea805532d8a317f"></a><!-- doxytag: member="tc14_dcf/applCode/dcf_taskDcf77.h::DCF_DIGITAL_LEVEL_DCF_IMPULSE" ref="a86b64e2058de1f8b2ea805532d8a317f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DCF_DIGITAL_LEVEL_DCF_IMPULSE&#160;&#160;&#160;false</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Boolean signal value, which is read in the instance of a time impulse. Whether it is a true or a false may depend on the receiver hardware and the interfacing circuitry and the implementation of the access function. The access function <a class="el" href="setup_8c.html#ab7e8b37e31cfdec90dd9bd09e3aae7b2">dcf_readDcfInput(void)</a> will return <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a86b64e2058de1f8b2ea805532d8a317f">DCF_DIGITAL_LEVEL_DCF_IMPULSE</a> if and only if one of the 100 or 200 ms impulses is active and seen at the input. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab7e8b37e31cfdec90dd9bd09e3aae7b2"></a><!-- doxytag: member="tc14_dcf/applCode/dcf_taskDcf77.h::dcf_readDcfInput" ref="ab7e8b37e31cfdec90dd9bd09e3aae7b2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean dcf_readDcfInput </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the next sample of the DCF input signal. To make the DCF task autonomous it doesn't implement any I/O itself. The read function is implemented by the client of the task. The client will take care of all relevant multi-tasking considerations.<br/>
 The function is executed in the context of the DCF task. It is called once every <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8c.html#a0a0fdfd7ce788d2a0352d2b297eddf23">ACTUAL_TASK_TIME_IN_S</a> seconds, which is the period time of the regular DCF task. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>dcfSignalValue The current DCF signal value is returned as a Boolean. The polarity is specified by means of a define, see <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a86b64e2058de1f8b2ea805532d8a317f">DCF_DIGITAL_LEVEL_DCF_IMPULSE</a>.</dd></dl>
<p>Get the next sample of the DCF input signal. To make the DCF task autonomous it doesn't implement any I/O itself. The read function is implemented by the client of the task. The client will take care of all relevant multi-tasking considerations.<br/>
 The function is executed in the context of the DCF task. It is called once every task tic of of the regular DCF task. This task tic is configured in the DCF module. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>dcfSignalValue The current dcf signal value is return as a Boolean. The polarity is specified by means of a define, see <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a86b64e2058de1f8b2ea805532d8a317f">DCF_DIGITAL_LEVEL_DCF_IMPULSE</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a64b2fea5d229953b7919a83c5e67aa7b"></a><!-- doxytag: member="tc14_dcf/applCode/dcf_taskDcf77.h::dcf_onNewTimeTelegram" ref="a64b2fea5d229953b7919a83c5e67aa7b" args="(const dcf_timeInfo *const pTimeInfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dcf_onNewTimeTelegram </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structdcf__time_info.html">dcf_timeInfo</a> *const&#160;</td>
          <td class="paramname"><em>pTimeInfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The callback function, which reports successful reception of new time information to the client of the DCF task. It is called in the instance of having another time telegram successfully decoded. (Bad telegrams are not reported to the client at all.)<br/>
 This callback is executed in the context of the DCF task. Data synchronization with the the event evaluating task needs to be implemented in the callback. To safely do so the priorities of the DCF and its client task need to be taken into consideration, see void <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a71042925c2f50707bfaabdba86e09bec">dcf_initializeTask(uint8_t, uint8_t)</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pTimeInfo</td><td>The pointer to the object holding the up-to-date time information. This information is accurate at the instance of callback execution. The object the parameter points to is accessible during callback execution only. Data needs to be copied while the callback executes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>It's not an option but a must that a callback function is defined. Otherwise the linker will report an unknown symbol.</dd></dl>
<p>Synchronize real time clock with DCF time information.<br/>
 This is the callback function, which reports successful reception of new time information to the client of the DCF task. It is called in the instance of having another time telegram successfully decoded. (Bad telegrams are not reported to the client at all.)<br/>
 This callback is executed in the context of the DCF task. Data synchronization with the the event evaluating task needs to be implemented in the callback. To safely do so the priorities of the DCF and its client task need to be taken into consideration, see void <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a71042925c2f50707bfaabdba86e09bec">dcf_initializeTask(uint8_t, uint8_t)</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pTimeInfo</td><td>The pointer to the object holding the up-to-date time information. This information is accurate at the instance of callback execution. The object the parameter points to is accessible during callback execution only. Data needs to be copied while the callback executes.</td></tr>
  </table>
  </dd>
</dl>
<p>The callback function, which reports successful reception of new time information to the client of the DCF task. It is called in the instance of having another time telegram successfully decoded. (Bad telegrams are not reported to the client at all.)<br/>
 This callback is executed in the context of the DCF task. Data synchronization with the the event evaluating task needs to be implemented in the callback. To safely do so the priorities of the DCF and its client task need to be taken into consideration, see void <a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html#a71042925c2f50707bfaabdba86e09bec">dcf_initializeTask(uint8_t, uint8_t)</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pTimeInfo</td><td>The pointer to the object holding the up-to-date time information. This information is accurate at the instance of callback execution. The object the parameter points to is accessible during callback execution only. Data needs to be copied while the callback executes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a71042925c2f50707bfaabdba86e09bec"></a><!-- doxytag: member="tc14_dcf/applCode/dcf_taskDcf77.h::dcf_initializeTask" ref="a71042925c2f50707bfaabdba86e09bec" args="(uint8_t idxTask, uint8_t prioClass)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dcf_initializeTask </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>idxTask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>prioClass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize the DCF task at RTuinOS startup time.</p>
<p>Initialize the autonomous DCF task in the RTuinOS kernel. The function encapsulates the call of rtos_initializeTask, thereby hiding most of its parameters and therefore reducing the complexity for the user. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">idxTask</td><td>The RTuinOS task index has to be passed. This index is almost meaningless but is needed to distinguish the tasks when calling the RTuinOS diagnostic functions. </td></tr>
    <tr><td class="paramname">prioClass</td><td>The priority class the DCF task should belong to. Basically the task has no high demands on priority. The signal processing is quite slow and the timing constraints when measuring the bit impulses are rather weak. The task will probably succeed even with low priority. Nonetheless, the priority can't be hidden: The user needs to take it into consideration ...<br/>
 ... when designing the notification callback, which delivers the new time information to the client of the task,<br/>
 ... when doing the static configuration of RTuinOS in rtos.config.h. Then the sizes of the priority classes need to be known. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>This function need to be called from function void <a class="el" href="setup_8c.html#a4fc01d736fe50cf5b977f755b675f11d">setup(void)</a>.</dd></dl>
<p>Initialize the autonomous DCF task in the RTuinOS kernel. The function encapsulates the call of rtos_initializeTask, thereby hiding most of its parameters and therefore reducing the complexity for the user. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">idxTask</td><td>The RTuinOS task index has to be passed. This index is almost meaningless but is needed to distinguish the tasks when calling the RTuinOS diagnostic functions. </td></tr>
    <tr><td class="paramname">prioClass</td><td>The priority class the DCF task should belong to. Basically the task has not high demands on priority. The signal processing is quite slow and the timing constraints when measuring the bit impulses are rather weak. The task will probably succeed even with low priority. Nonetheless, the priority can't be hidden: The user needs to take it in consideration<br/>
 when designing the notification callback, which delivers the new time information.<br/>
 when doing the static configuration of RTuinOS in rtos.config.h. The size of the priority classes has to be known. </td></tr>
  </table>
  </dd>
</dl>
<dl class="remark"><dt><b>Remarks:</b></dt><dd>This function need to be called from function void <a class="el" href="setup_8c.html#a4fc01d736fe50cf5b977f755b675f11d">setup(void)</a>. </dd></dl>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="tc14__dcf_2appl_code_2dcf__task_dcf77_8h.html">dcf_taskDcf77.h</a>      </li>
      <li class="footer">Generated on Wed Oct 16 2013 23:04:00 for RTuinOS by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
