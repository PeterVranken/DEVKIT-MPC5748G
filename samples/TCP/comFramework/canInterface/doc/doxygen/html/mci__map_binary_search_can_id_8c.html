<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>comFramework - CAN Interface: mci_mapBinarySearchCanId.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">comFramework - CAN Interface<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">comFramework - CAN Interface - A highly flexible CAN interface for embedded platforms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mci__map_binary_search_can_id_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mci_mapBinarySearchCanId.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mci__map_binary_search_can_id_8h_source.html">mci_mapBinarySearchCanId.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ede__basic_definitions_8h_source.html">ede_basicDefinitions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ede__external_interfaces_8h_source.html">ede_externalInterfaces.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mem__malloc_8h_source.html">mem_malloc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mci__if_map_binary_search_can_id_8h_source.html">mci_ifMapBinarySearchCanId.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aee9d146fbbe72d87f912ca09f072bf30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#aee9d146fbbe72d87f912ca09f072bf30">MCI_SUPPORT_EXTENDED_CAN_IDS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aee9d146fbbe72d87f912ca09f072bf30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3273ea7038862b73586dce61b9b21893"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#a3273ea7038862b73586dce61b9b21893">_STDC_VERSION_C11</a></td></tr>
<tr class="separator:a3273ea7038862b73586dce61b9b21893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e8aeb972ad7ddb728224373bb1cbb6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#a9e8aeb972ad7ddb728224373bb1cbb6f">_STDC_VERSION_C17_C11</a></td></tr>
<tr class="separator:a9e8aeb972ad7ddb728224373bb1cbb6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbf275a6ab4454ca5c2ab4ebf90d86c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#adbf275a6ab4454ca5c2ab4ebf90d86c4">INVALID_MAP_VALUE</a>&#160;&#160;&#160;((unsigned)(1ull&lt;&lt;(sizeof(<a class="el" href="mci__if_map_binary_search_can_id_8h.html#a060223eca20cde0756db5751b3899710">mci_uintMapValue_t</a>)*8u) - 1ull))</td></tr>
<tr class="separator:adbf275a6ab4454ca5c2ab4ebf90d86c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4bd938f37d61484cf93470b1d6ed68ce"><td class="memItemLeft" align="right" valign="top">typedef struct mapInstance_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#a4bd938f37d61484cf93470b1d6ed68ce">mapInstance_t</a></td></tr>
<tr class="separator:a4bd938f37d61484cf93470b1d6ed68ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337126cbc414f9ae3202ce7c8779159b"><td class="memItemLeft" align="right" valign="top">typedef struct map_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#a337126cbc414f9ae3202ce7c8779159b">map_t</a></td></tr>
<tr class="separator:a337126cbc414f9ae3202ce7c8779159b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae0ecda9ba584ddf020b37f6f75171ad7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mci__map_binary_search_can_id_8c.html#ae0ecda9ba584ddf020b37f6f75171ad7">mci_createMapBinarySearchCanId</a> (<a class="el" href="structede__map_sender_ev_handle_to_idx__t.html">ede_mapSenderEvHandleToIdx_t</a> *const pNewMap, unsigned int noKindsOfEv, const <a class="el" href="structmci__spec_map_instance__t.html">mci_specMapInstance_t</a> specInstanceAry[], <a class="el" href="structede__memory_pool__t.html">ede_memoryPool_t</a> *const pMemPool)</td></tr>
<tr class="separator:ae0ecda9ba584ddf020b37f6f75171ad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >This module provides a handle map, which relates the pair of kind-of-event and the 32 Bit integer representation of a CAN ID to the zero based index as used in the event dispatcher engine.<br  />
 Use case are some rare platforms that report CAN events (typically reception event or transmission complete event) by saying, which CAN ID was affected, rather than using a (zero based) message handle or index. This is the right map implementation to use on such systems: Kind of event will likely be the CAN bus index and the CAN ID is used as the 32 Bit integer map key.<br  />
 The implementation supports the interfaces defined by the event sender and dispatcher engine and the map is therefore most easy to use in this context. Just create a map object and pass it to the constructor of sender or dispatcher object.<br  />
 The implementation of this map uses a binary search for the (huge) range of 32 Bit integers. The complexity is O(log(n)), where n is the number of messages on a given bus. For standard CAN IDs, it is an option to apply a direct lookup table instead, which improves complexity to O(1), at the cost of a ROM table with 2048 entries per CAN bus. Which technique to apply to standard CAN IDs is a compile time decision.<br  />
 The binary search requires a sorted data table per CAN bus with all CAN IDs, which are in use on that bus. The straigh-forward decision is to use map API to build-up this table during the frame registration. While easy, it is not desirable, as it would cost a lot of expensive RAM. Instead, the concept is to let the comFramework code generator make the required tables in ROM. Therefore, this map implementation is no longer self-contained, it'll compile and work only, if the data tables are in place. This will normally mean that you are going to integrate the code generation templates from sample "mapCanIdToFrameIdx" of the code generator into your project.<br  />
 Most use cases will have a few kinds of event, which know an event handle for further distinction of events of the kind. (CAN: Message Rx and Tx events.) Many other events won't use a handle but stand for themselves. (CAN: Bus-off, bus on) To support these without wasting useless lookup RAM, the implementation offers an alternative, "simple" mapping: A single map value is stored for each of these kinds of events.</p>
<p >Copyright (C) 2022 Peter Vranken (<a href="#" onclick="location.href='mai'+'lto:'+'Pet'+'er'+'_Vr'+'an'+'ken'+'@Y'+'aho'+'o.'+'de'; return false;">Peter<span class="obfuscator">.nosp@m.</span>_Vra<span class="obfuscator">.nosp@m.</span>nken@<span class="obfuscator">.nosp@m.</span>Yaho<span class="obfuscator">.nosp@m.</span>o.de</a>)</p>
<p >This program is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or any later version.</p>
<p >This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</p>
<p >You should have received a copy of the GNU Lesser General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aee9d146fbbe72d87f912ca09f072bf30" name="aee9d146fbbe72d87f912ca09f072bf30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee9d146fbbe72d87f912ca09f072bf30">&#9670;&nbsp;</a></span>MCI_SUPPORT_EXTENDED_CAN_IDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MCI_SUPPORT_EXTENDED_CAN_IDS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3273ea7038862b73586dce61b9b21893" name="a3273ea7038862b73586dce61b9b21893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3273ea7038862b73586dce61b9b21893">&#9670;&nbsp;</a></span>_STDC_VERSION_C11</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _STDC_VERSION_C11</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9e8aeb972ad7ddb728224373bb1cbb6f" name="a9e8aeb972ad7ddb728224373bb1cbb6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e8aeb972ad7ddb728224373bb1cbb6f">&#9670;&nbsp;</a></span>_STDC_VERSION_C17_C11</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _STDC_VERSION_C17_C11</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adbf275a6ab4454ca5c2ab4ebf90d86c4" name="adbf275a6ab4454ca5c2ab4ebf90d86c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbf275a6ab4454ca5c2ab4ebf90d86c4">&#9670;&nbsp;</a></span>INVALID_MAP_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INVALID_MAP_VALUE&#160;&#160;&#160;((unsigned)(1ull&lt;&lt;(sizeof(<a class="el" href="mci__if_map_binary_search_can_id_8h.html#a060223eca20cde0756db5751b3899710">mci_uintMapValue_t</a>)*8u) - 1ull))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The reserved value "uninitialized" for those kinds of events, which don't make use of of a sender handle. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a4bd938f37d61484cf93470b1d6ed68ce" name="a4bd938f37d61484cf93470b1d6ed68ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd938f37d61484cf93470b1d6ed68ce">&#9670;&nbsp;</a></span>mapInstance_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct mapInstance_t mapInstance_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >One instance of the map. </p>

</div>
</div>
<a id="a337126cbc414f9ae3202ce7c8779159b" name="a337126cbc414f9ae3202ce7c8779159b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a337126cbc414f9ae3202ce7c8779159b">&#9670;&nbsp;</a></span>map_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct map_t map_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The map object. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae0ecda9ba584ddf020b37f6f75171ad7" name="ae0ecda9ba584ddf020b37f6f75171ad7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ecda9ba584ddf020b37f6f75171ad7">&#9670;&nbsp;</a></span>mci_createMapBinarySearchCanId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mci_createMapBinarySearchCanId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structede__map_sender_ev_handle_to_idx__t.html">ede_mapSenderEvHandleToIdx_t</a> *const&#160;</td>
          <td class="paramname"><em>pNewMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>noKindsOfEv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmci__spec_map_instance__t.html">mci_specMapInstance_t</a>&#160;</td>
          <td class="paramname"><em>specInstanceAry</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structede__memory_pool__t.html">ede_memoryPool_t</a> *const&#160;</td>
          <td class="paramname"><em>pMemPool</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Create new map object. It has <em>noKindsOfEv</em> independently operating instances, which relate to the same number of supported kinds of events. The map is capable of key-value pairs, where key is a CAN ID of the form <em><a class="el" href="structmci__pair_can_id_and_idx__t.html">mci_pairCanIdAndIdx_t</a></em>. </p><dl class="section return"><dt>Returns</dt><dd>The function returns <em>true</em> in case of success, <em>false</em> otherwise. The map is not usable in the latter case. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pNewMap</td><td>If the function returns <em>true</em>, then the new map object is returned by reference as * <em>pNewMap</em>. </td></tr>
    <tr><td class="paramname">noKindsOfEv</td><td>The map will have this number of independent instances.<br  />
 Caution, later at runtime, the argument <em>kindOfEvent</em> will be used as zero based index into the array of instances. Consequently, this map implementation must not be used, if the applied enumeration of event kinds is not zero based! </td></tr>
    <tr><td class="paramname">specInstanceAry</td><td>Each kind of event has its own map instance, internal to the created map object. Each of these instance will have individual properrties, in particular its own data tables. Therefore, the function requires the specification of <em>noKindsOfEv</em> map instance. They are bundled inside this array. The size of the array is <em>noKindsOfEv</em> and the entries relate in a one-by-one relations to the numeric values of the different kinds of event.<br  />
 Such a map instance is characterized mainly by the data tables and their number of entries. However, an instance may alternatively make use of the simple mapping only. Find the details of a map instance specification in the description of data type <em><a class="el" href="structmci__spec_map_instance__t.html">mci_specMapInstance_t</a></em>.<br  />
 The passed array needs to exist only during run-time of this function. </td></tr>
    <tr><td class="paramname">pMemPool</td><td>This memory pool (by reference) provides the memory for the new object. The map is used from the dispatcher system, so this memory pool should have the same access rights or restrictions as the one applied for creation of the related dispatcher objects. Usually, it'll even be the same one. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_b30582f9ff20b54dfb5d39c40ac29991.html">handleMaps</a></li><li class="navelem"><a class="el" href="mci__map_binary_search_can_id_8c.html">mci_mapBinarySearchCanId.c</a></li>
    <li class="footer">Generated on Tue Oct 4 2022 15:29:09 for comFramework - CAN Interface by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
