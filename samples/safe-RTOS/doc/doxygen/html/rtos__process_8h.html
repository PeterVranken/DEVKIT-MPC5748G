<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>safe-RTOS (VLE): rtos_process.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">safe-RTOS (VLE)
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">safe-RTOS (VLE) - A simple RTOS with safety support for MPC5643L</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('rtos__process_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rtos_process.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="typ__types_8h_source.html">typ_types.h</a>&quot;</code><br />
<code>#include &quot;rtos_ivorHandler.h&quot;</code><br />
<code>#include &quot;<a class="el" href="rtos_8h_source.html">rtos.h</a>&quot;</code><br />
</div>
<p><a href="rtos__process_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtos__process_desc__t.html">rtos_processDesc_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a643cf094ea71fd6e396ad6e7147bb23c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#a643cf094ea71fd6e396ad6e7147bb23c">RTOS_SYSCALL_SUSPEND_PROCESS</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a643cf094ea71fd6e396ad6e7147bb23c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5602cfecfa4dcc525695c0903c14d9e4"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structrtos__process_desc__t.html">rtos_processDesc_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#a5602cfecfa4dcc525695c0903c14d9e4">rtos_processDesc_t</a></td></tr>
<tr class="separator:a5602cfecfa4dcc525695c0903c14d9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac6c303426275b57500c1caede5496cbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rtos_8h.html#ae6a79bdc418d571b34528a8d2c9f49d1">rtos_errorCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#ac6c303426275b57500c1caede5496cbb">rtos_osInitProcesses</a> (bool isProcessConfiguredAry[1+<a class="el" href="rtos_8h.html#a18500a557ecd5ebbcefbacba22b58d7e">RTOS_NO_PROCESSES</a>])</td></tr>
<tr class="separator:ac6c303426275b57500c1caede5496cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f8200c57d5390e8937fc2a78af55b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#a68f8200c57d5390e8937fc2a78af55b6">rtos_osGrantPermissionSuspendProcess</a> (unsigned int pidOfCallingTask, unsigned int targetPID)</td></tr>
<tr class="separator:a68f8200c57d5390e8937fc2a78af55b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddb4b88dd8c1052eb41763e7164e7fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#aeddb4b88dd8c1052eb41763e7164e7fa">rtos_osSuspendProcess</a> (uint32_t PID)</td></tr>
<tr class="separator:aeddb4b88dd8c1052eb41763e7164e7fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63296923146f8dff5b8754ca1c6003dc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#a63296923146f8dff5b8754ca1c6003dc">rtos_isProcessSuspended</a> (uint32_t PID)</td></tr>
<tr class="separator:a63296923146f8dff5b8754ca1c6003dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0f1e1a247f858577c1d9d04e4a4331c"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#ab0f1e1a247f858577c1d9d04e4a4331c">rtos_getNoTotalTaskFailure</a> (unsigned int PID)</td></tr>
<tr class="separator:ab0f1e1a247f858577c1d9d04e4a4331c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb25bad5cf1976808e7acb79c30290bd"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#abb25bad5cf1976808e7acb79c30290bd">rtos_getNoTaskFailure</a> (unsigned int PID, unsigned int kindOfErr)</td></tr>
<tr class="separator:abb25bad5cf1976808e7acb79c30290bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a240a9b010103563bb950b8d69017703b"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rtos__process_8h.html#a240a9b010103563bb950b8d69017703b">rtos_getStackReserve</a> (unsigned int PID)</td></tr>
<tr class="separator:a240a9b010103563bb950b8d69017703b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Definition of global interface of module <a class="el" href="rtos__process_8c.html">rtos_process.c</a></p>
<p>Copyright (C) 2019 Peter Vranken (<a href="#" onclick="location.href='mai'+'lto:'+'Pet'+'er'+'_Vr'+'an'+'ken'+'@Y'+'aho'+'o.'+'de'; return false;">Peter<span style="display: none;">.nosp@m.</span>_Vra<span style="display: none;">.nosp@m.</span>nken@<span style="display: none;">.nosp@m.</span>Yaho<span style="display: none;">.nosp@m.</span>o.de</a>)</p>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a643cf094ea71fd6e396ad6e7147bb23c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RTOS_SYSCALL_SUSPEND_PROCESS&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Index of implemented system call for aborting running tasks belonging to a given process and stopping that process forever (i.e. no further task or I/O driver callback execution). </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a5602cfecfa4dcc525695c0903c14d9e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structrtos__process_desc__t.html">rtos_processDesc_t</a>  <a class="el" href="structrtos__process_desc__t.html">rtos_processDesc_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run-time data describing a process. An object of this type must be allocated in RAM, which is not write-permitted for user code. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac6c303426275b57500c1caede5496cbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rtos_8h.html#ae6a79bdc418d571b34528a8d2c9f49d1">rtos_errorCode_t</a> rtos_osInitProcesses </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isProcessConfiguredAry</em>[1+RTOS_NO_PROCESSES]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the data structure with all process descriptors.</p>
<p>Initialize the data structure with all process descriptors on the calling core. This mainly means to initialize the stack memory on the calling core. (Processes are shared between the core but their implementation requires an own stack on each of the cores.) Each core needs to call this function. </p><dl class="section return"><dt>Returns</dt><dd>The function returns a non zero value from enumeration <em>rtos_errorCode_t</em> if a configuration error is detected. The software must not start up in this case. Normally, you will always receive a <em>rtos_err_noError</em> (zero). Since it is only about static configuration, the returned error may be appropriately handled by an assertion. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">isProcessConfiguredAry</td><td>This array contains an entry for each of the supported processes. After return, the entry with index i tells, whether the process with PID i is configured for use. (Which mainly relates to some stack space configured or not in the linker script.)<br />
 Note, isProcessConfiguredAry[0] relates to the OS and will always be <em>true</em>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a68f8200c57d5390e8937fc2a78af55b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtos_osGrantPermissionSuspendProcess </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>pidOfCallingTask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>targetPID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Grant permission to particular processes for using the service <a class="el" href="rtos_8h.html#a50d3acde6c733f5dcf8decab6299e3ff">rtos_suspendProcess()</a>.</p>
<p>Operating system initialization function: Grant permissions for using the service rtos_suspendProcess to particular processes. By default, the use of that service is not allowed.<br />
 By principle, offering service rtos_suspendProcess makes all processes vulnerable, which are allowed as target for the service. A failing, straying process can always hit some ROM code executing the system call with arbitrary register contents, which can then lead to immediate task abortion in and suspension of an otherwise correct process.<br />
 This does not generally break the safety concept, the potentially harmed process can for example be anyway supervised by another, non-suspendable supervisory process. Consequently, we can offer the service at least on demand. A call of this function enables the service for a particular pair of calling process and targeted process. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pidOfCallingTask</td><td>The tasks belonging to process with PID <em>pidOfCallingTask</em> are granted permission to suspend another process. The range is 1 .. <a class="el" href="rtos_8h.html#a18500a557ecd5ebbcefbacba22b58d7e">RTOS_NO_PROCESSES</a>, which is double-checked by assertion. </td></tr>
    <tr><td class="paramname">targetPID</td><td>The process with PID <em>targetPID</em> is suspended. The range is 1 .. maxPIDInUse-1, which is double-checked later. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>It would break the safety concept if we permitted the process with highest privileges to become the target of the service. This is double-checked not here (when it is not yet defined, which particular process that will be) but as part of the RTOS startup procedure; a bad configuration can therefore lead to a later reported run-time error. </dd>
<dd>
This function must be called from the OS context only. It is intended for use in the operating system initialization phase. It is not reentrant. The function needs to be called prior to <a class="el" href="rtos_8h.html#ab24d0fa9208d5675e03cc931a08e52fd">rtos_osInitKernel()</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="aeddb4b88dd8c1052eb41763e7164e7fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtos_osSuspendProcess </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>PID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function to suspend a process.</p>
<p>Kernel function to suspend a process. All currently running tasks belonging to the process are aborted and the process is stopped forever (i.e. there won't be further task starts or I/O driver callback invocations).<br />
 If the kernel is started on more than one core and if several cores share the same process then the function still relates to only those tasks of the process, which are configured to run on the calling core. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PID</td><td>The ID of the process to suspend in the range 1..4. Checked by assertion. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>Tasks of the suspended process can continue running for a short while until their abort conditions are checked the next time. The likelihood of such a continuation is little and the duration is in the magnitude of a Millisecond. </dd>
<dd>
This function must be called from the OS context only. Any attempt to use it in user code will lead to a privileged exception. </dd></dl>

</div>
</div>
<a class="anchor" id="a63296923146f8dff5b8754ca1c6003dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool rtos_isProcessSuspended </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>PID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Kernel function to read the suspend status of a process.</p>
<p>Kernel function to read the suspend status of a process. This function is a simple counterpart to <a class="el" href="rtos__process_8c.html#aeddb4b88dd8c1052eb41763e7164e7fa">rtos_osSuspendProcess()</a>. It will return <em>true</em> after the other function had been called for the given process ID or if the process is not at all in use. </p><dl class="section return"><dt>Returns</dt><dd>Get <em>false</em> as long as the process is still active, <em>true</em> otherwise. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PID</td><td>The ID of the queried process in the range 1..4. Checked by assertion. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function can be called from OS and user context. </dd></dl>

</div>
</div>
<a class="anchor" id="ab0f1e1a247f858577c1d9d04e4a4331c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int rtos_getNoTotalTaskFailure </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>PID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the number of task failures counted for the given process since start of the kernel.</p>
<p>Get the number of task failures (and task abortions at the same time) counted for the given process since start of the kernel on the calling core. </p><dl class="section return"><dt>Returns</dt><dd>Get total number of errors counted for process <em>PID</em>.<br />
 If the kernel is started on more than one core and if several cores share the same process then the function still returns only those process errors, which had been caught on the calling core. Explicit cross-core communication will be required to query the failures counted for the same process on another core, too. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PID</td><td>The ID of the queried process in the range 1 .. RTOS_NO_PROCESSES. An out of range PID will always yield UINT_MAX and an assertion fires in DEBUG compilation. An unused process has no errors. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function can be called from both, a user task or the OS context. </dd></dl>

</div>
</div>
<a class="anchor" id="abb25bad5cf1976808e7acb79c30290bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int rtos_getNoTaskFailure </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>PID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>kindOfErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the number of task failures of given category for the given process.</p>
<p>Get the number of task failures of given category counted for the given process since start of the kernel on the calling core. </p><dl class="section return"><dt>Returns</dt><dd>Get total number of errors of category <em>kindOfErr</em> counted for process <em>PID</em>.<br />
 If the kernel is started on more than one core and if several cores share the same process then the function still returns only those process errors, which had been caught on the calling core. Explicit cross-core communication will be required to query the failures counted for the same process on another core, too. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PID</td><td>The ID of the queried process in the range 1 .. RTOS_NO_PROCESSES. An out of range PID will always yield UINT_MAX and an assertion fires in DEBUG compilation. An unused process has no errors. </td></tr>
    <tr><td class="paramname">kindOfErr</td><td>The category of the error. See file rtos_ivorHandler.h, <a class="el" href="rtos_8h.html#a5c3c87d0d5a675b6ebe299611b001193">RTOS_ERR_PRC_MACHINE_CHECK</a> and following, for the enumerated error causes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>This function can be called from both, a user task or the OS context. </dd></dl>

</div>
</div>
<a class="anchor" id="a240a9b010103563bb950b8d69017703b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int rtos_getStackReserve </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>PID</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute how many bytes of the stack area are still unused.</p>
<p>Compute how many bytes of the stack area of a process are still unused on the calling core. If the value is requested after an application has been run a long while and has been forced to run through all its conditional code paths, it may be used to optimize the static stack allocation. The function is useful only for diagnosis purpose as there's no chance to dynamically increase or decrease the stack area at runtime.<br />
 The function may be called from a task, ISR and from the idle task.<br />
 The algorithm is as follows: The unused part of the stack is initialized with a specific pattern word. This routine counts the number of subsequent pattern words down from the (logical) top of the stack area. The result is returned as number of bytes.<br />
 The returned result must not be trusted too much: It could of course be that a pattern word is found not because of the initialization but because it has been pushed onto the stack - in which case the return value is too great (too optimistic). The probability that this happens is significantly greater than zero. The chance that two pattern words had been pushed is however much less and the probability of three, four, five such words in sequence is negligible. Any stack size optimization based on this routine should therefore subtract e.g. eight bytes from the returned reserve and diminish the stack outermost by this modified value.<br />
 Be careful with operating system stack size optimization based only on this routine. The OS stack takes all interrupt stack frames. Even if the application ran a long time there's a significant probability that there has not yet been the deepest possible nesting of interrupts in the very instance that the code execution was busy in the deepest nested sub-routine of any of the service routines, i.e. when having the largest imaginable stack consumption for the OS stack. (Actually, the likelihood of not seeing this is rather close to one than close to zero.) A good suggestion therefore is to add the product of ISR stack frame size with the number of IRQ priority levels in use to the measured OS stack use and reduce the allocated stack memory only on this basis.<br />
 The IRQ stack frame is 96 Byte for normal IRQs and 200 Byte for those, which may start a user task (SW IRQs and I/O IRQs with callback into user code).<br />
 In the worst case, with 15 IRQ priority levels, this can sum up to 3 kByte. The stack reserve of a "safe" application should be in this order of magnitude. </p><dl class="section return"><dt>Returns</dt><dd>The number of still unused stack bytes of the given process. See function description for details. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PID</td><td>The process ID the query relates to. (Each process has its own stack.) ID 0 relates to the OS/kernel stack. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>The computation is a linear search for the first non-pattern word and thus relatively expensive. It's suggested to call it only in some specific diagnosis compilation or occasionally from the idle task. </dd>
<dd>
This function can be called from both, the OS context and a user task. </dd>
<dd>
This function my be called even from a core, which is not running safe-RTOS. Hoever, the use is restricted to PID 0, the OS stack, which is the only one is use on such a core. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_9cd24f4fec2e6f6bedbcc5407321d78a.html">system</a></li><li class="navelem"><a class="el" href="dir_34effe5aae1be93d744f092611be46f1.html">RTOS</a></li><li class="navelem"><a class="el" href="rtos__process_8h.html">rtos_process.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
